

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NUFFT(device) &mdash; PyNUFFT 2020.2.6 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PyNUFFT 2020.2.6 documentation" href="../index.html"/>
        <link rel="up" title="Manual" href="init.html"/>
        <link rel="next" title="Multiple NUFFT instances" href="multiple_NUFFT.html"/>
        <link rel="prev" title="NUFFT" href="NUFFT_cpu.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PyNUFFT
          

          
            
            <img src="../_static/logo.jpeg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2020.2.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/init.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/init.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutor/init.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="init.html">Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="NUFFT_cpu.html">NUFFT</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NUFFT(device)</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_NUFFT.html">Multiple NUFFT instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple_NUFFT.html#multiprocessing-experimental">Multiprocessing (experimental)</a></li>
<li class="toctree-l2"><a class="reference internal" href="realistic_om.html">k-Space trajectories (om)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../API/init.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versionhistory.html">Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknow/init.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyNUFFT</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="init.html">Manual</a> &raquo;</li>
        
      <li>NUFFT(device)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/manu/NUFFT_hsa.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nufft-device">
<h1>NUFFT(device)<a class="headerlink" href="#nufft-device" title="Permalink to this headline">¶</a></h1>
<p><strong>The NUFFT(device) class</strong></p>
<p>NUFFT(device) computes NUFFT on the CUDA/OpenCL device.</p>
<p>Defining the equispaced to non-Cartesian transform as  operator <span class="math notranslate nohighlight">\(A\)</span>, the
NUFFT(device) class provides the following methods:</p>
<ul class="simple">
<li><p>forward() method computes the single forward operation <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>adjoint() method computes the single adjoint operation  <span class="math notranslate nohighlight">\(A^H\)</span>.</p></li>
<li><p>selfadjoint() method computes the single selfadjoint operation <span class="math notranslate nohighlight">\(A^H A\)</span>.</p></li>
<li><p>solve() method now only offers ‘cg’, ‘dc’, ‘L1TVOLS’</p></li>
</ul>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p>NUFFT.ndims: the dimension</p></li>
<li><p>NUFFT.ft_axes: the axes where the FFT takes place</p></li>
<li><p>NUFFT.Nd: Tuple, the dimensions of the image</p></li>
<li><p>NUFFT.Kd: Tuple, the dimensions of oversampled k-space</p></li>
</ul>
<p><strong>Acceleration on PyCUDA/PyOpenCL</strong></p>
<p>The NUFFT_hsa was designed to accelerate the NUFFT function
on the multi-core CPU and GPU, using PyOpenCL and PyCUDA backends.
This was made possible by using Reikna meta-package.</p>
<p>If multiple NUFFT(device) objects are created with the PyCUDA backend,
each call can be executed only after the  context has ‘popped up’. This is
achieved by the decorator function push_cuda_context():
calling NUFFT(device) methods will trigger the decorator and get the context popped up.
However, PyOpenCL has no such restriction
and the call will automatically bypass the decorator for the NUFFT(device)
with the PyOpenCL backend.</p>
<p>Different objects can be constructed on different PyCUDA and PyOpenCL backends.</p>
<p><strong>The life-cycle of the PyNUFFT(device) object</strong></p>
<p>NUFFT(device) employs the plan-execution two-stage model.
This can maximize the runtime speed, at the cost of the extra precomputation times and extra memory.</p>
<p>Instantiating an NUFFT(device) instance also initiates the context and defines some instance attributes.
The context is linked to the accelerator and the kernels are compiled on the chosen device.
Instance attributes will be replaced later when the method plan() is called.</p>
<p>Then the plan() method calls the helper.plan() function,
which constructs the scaling factor and the interpolator.
The interpolator is precomputed and stored as multiple 1D ELLpack (ELL) sparse matrices.
Each ELL matrix preserves the sparse matrix as the data and column indices.
Multi-dimensional interpolators are implemented as a concatenated multiple 1D ELL sparse matrices.
The actual data and column indices are inferred from the meshindex.
At the end of the plan() method, the offload() method transfers the
precomputed arrays to the accelerator.</p>
<p>The run-time computations reuse the saved scaling factors and
interpolators.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="multiple_NUFFT.html" class="btn btn-neutral float-right" title="Multiple NUFFT instances" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="NUFFT_cpu.html" class="btn btn-neutral" title="NUFFT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2020, PyNUFFT services.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2020.2.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>