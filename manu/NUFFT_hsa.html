

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NUFFT_hsa (deprecated) &mdash; PyNUFFT 2020.2.1  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PyNUFFT 2020.2.1  documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PyNUFFT
          

          
            
            <img src="../_static/logo.jpeg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2020.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/init.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/init.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutor/init.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="init.html">Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API/init.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versionhistory.html">Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknow/init.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyNUFFT</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>NUFFT_hsa (deprecated)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/manu/NUFFT_hsa.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nufft-hsa-deprecated">
<h1>NUFFT_hsa (deprecated)<a class="headerlink" href="#nufft-hsa-deprecated" title="Permalink to this headline">¶</a></h1>
<p><strong>The NUFFT_hsa class</strong></p>
<p>Defining the equispaced to non-Cartesian transform as  operator <span class="math notranslate nohighlight">\(A\)</span>, the
NUFFT_hsa class provides the following methods:</p>
<ul class="simple">
<li><dl class="simple">
<dt>forward() method computes the single-coil to single-coil, or multi-coil to</dt><dd><p>multi-coil (batch mode) forward operation <span class="math notranslate nohighlight">\(A\)</span>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>adjoint() method computes the single-coil to single-coil, or multi-coil to</dt><dd><p>multi-coil  (batch mode) adjoint operation  <span class="math notranslate nohighlight">\(A^H\)</span>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>selfadjoint() method computes the single-coil to single-coil, or multi-coil</dt><dd><p>to multi-coil (batch mode) selfadjoint operation <span class="math notranslate nohighlight">\(A^H A\)</span>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>forward_one2many() method computes the single-coil to multi-coil forward</dt><dd><p>operation <span class="math notranslate nohighlight">\(A\)</span> in batch mode. The single-coil image is copied to
multi-coil images before transform. If set_sense() is called first,
multi-coil images will be implicitly multiplied by the coil
sensitivities before transform. If set_sense() is never called,
multi-coil images will not be changed by the coil sensitivities before
transform.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>adjoint_many2one() method computes the multi-coil to single-coil adjoint</dt><dd><p>operation  <span class="math notranslate nohighlight">\(A^H\)</span> in batch mode.
The final reduction will divide the summed image by the number of
coils. If set_sense() is called first, multi-coil images will be
implicitly multiplied by the conjugate of coil sensitivities before
reduction. If set_sense() is never called, multi-coil images will not
be changed by the coil sensitivities before reduction.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>selfadjoint_one2many2one () method computes the single-coil to single-coil</dt><dd><p>selfadjoint operation <span class="math notranslate nohighlight">\(A^H A\)</span> in batch mode.
It connects forward_one2many() and adjoint_many2one() methods.
If set_sense() is called first, coil sensitivities and the conjugate
are used during forward_one2many() and adjoint_many2one().</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>solve() method links many solvers in pynufft.linalg.solver_cpu,</dt><dd><p>which is based on the solvers of scipy.sparse.linalg.cg,
scipy.sparse.linalg.’lsqr’, ‘dc’, ‘bicg’, ‘bicgstab’, ‘cg’,
‘gmres’, ‘lgmres’</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p>NUFFT_hsa.ndims: the dimension</p></li>
<li><p>NUFFT_hsa.ft_axes: the axes where the FFT takes place</p></li>
<li><dl class="simple">
<dt>NUFFT_hsa.parallel_flag: 1 for parallel transform.</dt><dd><p>0 for single channel.
If 1, the additional axis is batch.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>NUFFT_hsa.batch: internal attribute saving the number of channels.</dt><dd><p>If parallel_flag is 0, the batch is 1.
Otherwise, the batch must be given explicitly during planning.</p>
</dd>
</dl>
</li>
<li><p>NUFFT_hsa.Nd: Tuple, the dimensions of the image</p></li>
<li><p>NUFFT_hsa.Kd: Tuple, the dimensions of oversampled k-space</p></li>
</ul>
<p><strong>Acceleration on PyCUDA/PyOpenCL</strong></p>
<p>The NUFFT_hsa was designed to accelerate the NUFFT function
on the multi-core CPU and GPU, using PyOpenCL and PyCUDA backends.
This was made possible by using Reikna meta-package.</p>
<p>If multiple NUFFT_hsa objects are created with the PyCUDA backend,
each call can be executed only after the  context has ‘popped up’. This is
achieved by the decorator function push_cuda_context():
calling NUFFT_hsa methods will trigger the decorator and get the context popped up.
However, PyOpenCL has no such restriction
and the call will automatically bypass the decorator for the NUFFT_hsa
with the PyOpenCL backend.</p>
<p>Different objects can be constructed on different PyCUDA and PyOpenCL backends.</p>
<p><strong>The life-cycle of the PyNUFFT_hsa object</strong></p>
<p>NUFFT_hsa employs the plan-execution two-stage model.
This can maximize the runtime speed, at the cost of the extra precomputation times and extra memory.</p>
<p>Instantiating an NUFFT_hsa instance also initiates the context and defines some instance attributes.
The context is linked to the accelerator and the kernels are compiled on the chosen device.
Instance attributes will be replaced later when the method plan() is called.</p>
<p>Then the plan() method calls the helper.plan() function,
which constructs the scaling factor and the interpolator.
The interpolator is precomputed and stored as multiple 1D ELLpack (ELL) sparse matrices.
Each ELL matrix preserves the sparse matrix as the data and column indices.
Multi-dimensional interpolators are implemented as a concatenated multiple 1D ELL sparse matrices.
The actual data and column indices are inferred from the meshindex.
At the end of the plan() method, the offload() method transfers the
precomputed arrays to the accelerator.</p>
<p>The run-time computations reuse the saved scaling factors and
interpolators.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2020, PyNUFFT services.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2020.2.1 ',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>